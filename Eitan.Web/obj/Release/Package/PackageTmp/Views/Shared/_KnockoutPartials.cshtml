<div id="releases-container" class="model-collection-container">
    <div id="releases-div" class="model-collection-wrap" data-bind="template: {foreach: Releases, afterAdd: releaseAdded}">
        <div class="release-item model-item isotope-item">
            <a data-bind="attr:{href: '/Releases/Details/' + ID, 'class': 'release-type-' + TypeID}">
                <div class="portfolio-item-holder">
                    <div class="portfolio-item-hover-content">
                        <div class="portfolio-content-wrap" style="top: 150%;">
                            <div data-rel="prettyPhoto" class="zoom"></div>
                            <span class="portfolio-type" data-bind="text: Type">Discography </span>
                            <div class="portfolio-content-title" data-bind="text: SubTitle">
                            </div>
                        </div>
                        <img class="model-item-image" data-bind="attr:{src: '/Images/Releases/thumb_' + ImagePath, title: Title, alt: Title}" />
                        <div class="release-item-bar standard-list-bar" data-bind="text: Title"></div>
                        <div class="hover-options" style="opacity: 0;"></div>
                    </div>
                </div>
            </a>
        </div>
    </div>
    <input type="button" class="btn-more-Releases btn-more" data-name="Releases" data-path="Releases" data-page="1" value="More Releases" />
</div>
<div id="projects-container" class="model-collection-container">
    <div id="projects-div" class="model-collection-wrap" data-bind="template: {foreach: Projects, afterAdd: projectAdded}">
        <div class="project-item model-item isotope-item">
            <a data-bind="attr:{href: '/Projects/Details/' + ID}">
                <div class="portfolio-item-holder">
                    <div class="portfolio-item-hover-content">
                        <div class="portfolio-content-wrap" style="top: 150%;">
                            <div data-rel="prettyPhoto" class="zoom"></div>
                            <span class="portfolio-type" data-bind="text: SubTitle">Project </span>
                            <div class="portfolio-content-title" data-bind="text: Title">
                            </div>
                        </div>
                        <img class="model-item-image" data-bind="attr:{src: '/Images/Projects/thumb_' + ImagePath, title: Title, alt: Title}" />
                        @*<div class="project-item-bar standard-list-bar" data-bind="text: Title"></div>*@
                        <div class="hover-options" style="opacity: 0;"></div>
                    </div>
                </div>
            </a>
        </div>
    </div>
    <input type="button" class="btn-more-Projects btn-more" data-name="Projects" data-path="Projects" data-page="1" value="More Projects" />
</div>
<div id="news-container" class="model-collection-container">
    <div id="news-div" class="model-collection-wrap" data-bind="template: {foreach: News, afterAdd: newsAdded}">
        <div class="news-item model-item isotope-item">
            <a data-bind="attr:{href: '/News/Details/' + ID}">
                <div class="news-item-image-wrap">
                    <img class="model-item-image" data-bind="attr:{src: '/Images/News/thumb_' + ImagePath, title: Title, alt: Title}" />
                </div>
                <div class="news-item-text">
                    <h2 data-bind="text: Title"></h2>
                    <div class="news-text-content" data-bind="text: Content + ' More..'">
                    </div>
              
                    <div class="news-text-date" data-bind="text: Creation">
                    </div>
                </div>
            </a>
        </div>
    </div>
    <input type="button" class="btn-more-News btn-more" data-path="News" data-name="News" data-page="1" value="More News" />
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var History = window.History, // Note: We are using a capital H instead of a lower h
                State = History.getState(),
                $log = $('#log');

        ko.applyBindings(ViewModel);

        $("#releases-div").isotope({
            layoutMode: 'fitRows',
            itemSelector: '.isotope-item'
        });

        $("#projects-div").isotope({
            layoutMode: 'fitRows',
            itemSelector: '.isotope-item'
        });

        $("#news-div").isotope({
            layoutMode: 'fitRows',
            animationOptions: {
                duration: 750,
                easing: 'easeInOutBack',
                queue: false
            },
            itemSelector: '.isotope-item'
        });

        $(".btn-more").click(function () {

            var name = $(this).data("name");
            var path = $(this).data("path");
            var page = $(this).data("page");
            page++;
            var data = "?json=true&page=" + page;
            var Objects = eval("ViewModel." + name);

            $(this).data("page", page);

            if (name == "News")
                GetFromWebApiDetails(ViewModel.News, "News", data, ".btn-more-News");
            else
                GetFromWebApi(Objects, path, data, ".btn-more-" + name);

            $('html, body').animate({ scrollTop: $(document).height() }, 'slow');
        });


        History.Adapter.bind(window, 'statechange', function () { // Note: We are using statechange instead of popstate
            // Log the State
            var State = History.getState(); // Note: We are using History.getState() instead of event.state
            if (State.data.nav != null) {
                var type = State.data.nav;

                $("#render-body").hide();
                reset_isotope(type);
                eval("ViewModel.Load" + type + "();");
            }
            else
                window.location = "/";
        });

        $(".AjaxLink").click(function () {

            var type = $(this).data("type");

            $("#render-body").hide();

            History.pushState({ state: type, nav: type }, type, "/" + type + "/");

            return false;

        });
    });

    function reset_isotope(colname) {
    }
</script>
